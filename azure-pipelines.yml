trigger:
  - main

pool:
  vmImage: 'ubuntu-latest'

steps:
  - script: npm ci
    displayName: "npm ci"

  - script: npm run check
    displayName: "Run Linter Check"
    condition: succeededOrFailed()

  - script: npm run build
    displayName: "Run TypeScript Build"

  - task: ArchiveFiles@1
    displayName: "Archive files"
    inputs:
      rootFolder: "$(System.DefaultWorkingDirectory)"
      includeRootFolder: false

  - task: CopyFiles@2
    displayName: "Copy File to: $(TargetFolder)"
    inputs:
      SourceFolder: "$(Build.ArtifactStagingDirectory)"
      Contents: "$(Build.BuildId).zip"
      TargetFolder: '$(Build.ArtifactStagingDirectory)\ArtifactsToBePublished'

  - task: PublishBuildArtifacts@1
    displayName: "Publish Artifact: drop"
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)\ArtifactsToBePublished'
